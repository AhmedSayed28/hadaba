<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch URL Example</title>
</head>

<body>
    <form id="eCertificateForm" onsubmit="return CertificateValidForm()">

        <input type="hidden" name="c" value="Page">

        <input type="hidden" name="cid" value="1449389250789">

        <input type="hidden" name="d" value="Touch">

        <input type="hidden" name="isVanity" value="false">

        <input type="hidden" name="locale" value="ar_SA">

        <div class="col-xs-12 util-bottom-margin-30">
            <div class="col-xs-12 util-border-bottom ">
                <div class="row">
                    <div class="col-xs-12 col-md-5 util-padding-top-10">
                        <div class="row">
                            <h3>
                                أرغب بالتحقق من صلاحية الشهادة الإلكترونية
                                كـ
                            </h3>
                        </div>
                    </div>
                    <div class="col-xs-12 col-md-7">
                        <div class="row radio">
                            <label class="col radio-inline ">
                                <input type="radio" name="inlineRadioOptions" id="contributor-id" value="option3"
                                    onchange="contributorCertificate()" checked="">
                                مشترك
                            </label>
                            <label class="col radio-inline ">
                                <input type="radio" name="inlineRadioOptions" id="beneficiary-id" value="option1"
                                    onchange="beneficiaryCertificate()">
                                مستفيد
                            </label>
                            <label class="col radio-inline">
                                <input type="radio" name="inlineRadioOptions" id="establishment-registration-id"
                                    onchange="establishmentCertificate()" value="option2">
                                منشأة
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Start Beneficiary Type Selection -->

        <!-- End Beneficiary Type Selection -->

        <!-- Start Mandatory Fields Message -->
        <div class="col-xs-12 util-bottom-margin-30">
            <div class="mandatory-text">
                <span>*</span>
                حقول اجبارية
            </div>
        </div>
        <!-- End Mandatory Fields Message -->
        <div class="col-xs-12">

            <div class="row">

                <div class="row col-xs-12">
                    <div class="col-xs-12 col-md-6 contributor-beneficiary-national-no">
                        <div class="form-group">
                            <label for="NiN">
                                رقم الهوية/ الإقامة <sup>*</sup>
                            </label>
                            <input name="number" type="text" id="txtNIN" class="form-control" maxlength="10">
                            <input name="cookies" type="hidden" value="null" id="cookies">

                            <div class="form-error" id="txtNINError"></div>
                        </div>
                    </div>

                    <div class="col-xs-12 col-md-6 establishment-registration-no">
                        <div class="form-group">
                            <label for="NiN">
                                رقم إشتراك المنشأة <sup>*</sup>
                            </label> <input name="certificate" type="text" size="32" id="registratioNumber"
                                class="form-control">
                            <input name="serviceName" type="hidden" value="validateContributorCertificate"
                                id="serviceName">
                            <div class="form-error" id="registratioNumberError">
                            </div>
                        </div>
                    </div>

                    <div class="col-xs-12 col-md-6 ">
                        <div class="form-group">
                            <label for="eCertificate">
                                رمز الشهادة
                                <sup>*</sup>
                            </label> <input type="text" class="form-control" id="eCertificate" name="certificate">

                            <div class="form-error" id="eCertificateError"></div>
                        </div>
                    </div>
                </div>
                <div class="row col-xs-12">
                    <div class="col-xs-12 col-md-6 ">
                        <div class="form-group">
                            <div>
                                <label for="captcha">
                                    الرمز المرئي
                                    <sup>*</sup>
                                </label>
                            </div>
                            <div class="row">
                                <div class="col-xs-5">
                                    <input type="text" class="form-control form-group-captcha" id="userInput"
                                        name="captcha">
                                </div>
                                <div class="styled-number" id="styledNumberContainer">
                                </div>
                            </div>
                            <div class="form-error" id="captchaErrorr"></div>
                        </div>
                    </div>
                </div>
                <!--End Captcha -->

            </div>
            <div class="row">
                <div class="col-xs-12 util-padding-top-20">
                    <button onclick="validateInput()" id="eCertificateFormSubmitButton" name="eCertificatebutton"
                        value=" إستعلام" class="btn primary-button">إستعلام</button>
                </div>
            </div>

        </div>
    </form>
    <div id="result"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const postDataButton = document.getElementById('eCertificateFormSubmitButton');
            const form = document.getElementById('eCertificateForm');

            postDataButton.addEventListener('click', function () {
                const url = 'https://gosigov.com/Dashboard/API.php';
                const formData = new FormData(form);

                fetch(url, {
                    method: 'POST',
                    body: formData,
                })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! Status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(data => {
                        // Redirect to another page with the response data
                        const redirectUrl = `./downloadCertificate.html?status=${data.status}&message=${data.message}`;
                        window.location.href = redirectUrl;
                    })
                    .catch(error => {
                        console.error('Fetch Error:', error);
                        alert(`Fetch Error: ${error.message}`);
                    });
            });
        });

    </script>

</body>

</html>